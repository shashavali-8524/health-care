<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthcare Backend â€” Architecture &amp; Flow Diagrams</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #0f172a; --surface: #1e293b; --card: #334155;
            --primary: #3b82f6; --primary-light: #60a5fa; --accent: #22d3ee;
            --success: #22c55e; --warning: #f59e0b; --danger: #ef4444;
            --text: #f1f5f9; --text-muted: #94a3b8; --border: #475569;
        }
        body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
        
        /* â”€â”€ Header â”€â”€ */
        .hero { background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 50%, #1a1a2e 100%); padding: 60px 40px; text-align: center; border-bottom: 2px solid var(--primary); }
        .hero h1 { font-size: 2.8rem; background: linear-gradient(90deg, var(--primary-light), var(--accent)); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; }
        .hero p { color: var(--text-muted); font-size: 1.15rem; max-width: 700px; margin: 0 auto; }
        .tech-badges { display: flex; gap: 12px; justify-content: center; margin-top: 24px; flex-wrap: wrap; }
        .tech-badge { background: var(--card); border: 1px solid var(--border); padding: 6px 16px; border-radius: 20px; font-size: 0.85rem; color: var(--accent); font-weight: 600; }

        /* â”€â”€ Navigation Tabs â”€â”€ */
        .tab-nav { display: flex; justify-content: center; gap: 8px; padding: 20px 20px 0; flex-wrap: wrap; position: sticky; top: 0; background: var(--bg); z-index: 100; border-bottom: 1px solid var(--border); padding-bottom: 16px; }
        .tab-btn { background: var(--surface); border: 1px solid var(--border); color: var(--text-muted); padding: 10px 22px; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 0.9rem; font-weight: 600; transition: all 0.2s; }
        .tab-btn:hover { color: var(--text); border-color: var(--primary); }
        .tab-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* â”€â”€ Sections â”€â”€ */
        .tab-content { display: none; padding: 40px; max-width: 1200px; margin: 0 auto; }
        .tab-content.active { display: block; }
        .tab-content h2 { font-size: 1.8rem; margin-bottom: 8px; color: var(--primary-light); }
        .tab-content .subtitle { color: var(--text-muted); margin-bottom: 30px; font-size: 1rem; }

        /* â”€â”€ Flow Diagram Containers â”€â”€ */
        .flow-container { background: var(--surface); border: 1px solid var(--border); border-radius: 12px; padding: 30px; margin-bottom: 30px; }
        .flow-container h3 { color: var(--accent); margin-bottom: 20px; font-size: 1.2rem; }

        /* â”€â”€ SVG Flow Diagrams â”€â”€ */
        .flow-svg { width: 100%; overflow-x: auto; }
        .flow-svg svg { display: block; margin: 0 auto; }

        /* â”€â”€ Architecture Boxes â”€â”€ */
        .arch-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .arch-card { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 24px; transition: transform 0.2s, border-color 0.2s; cursor: default; }
        .arch-card:hover { transform: translateY(-3px); border-color: var(--primary); }
        .arch-card .icon { font-size: 2rem; margin-bottom: 10px; }
        .arch-card h4 { color: var(--primary-light); margin-bottom: 6px; }
        .arch-card p { color: var(--text-muted); font-size: 0.9rem; }
        .arch-card code { background: var(--bg); padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; color: var(--accent); }

        /* â”€â”€ Interactive Flow Steps â”€â”€ */
        .flow-steps { display: flex; flex-direction: column; gap: 0; }
        .flow-step { display: flex; align-items: flex-start; gap: 20px; position: relative; }
        .flow-step-line { width: 40px; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; }
        .flow-step-dot { width: 20px; height: 20px; border-radius: 50%; border: 3px solid var(--primary); background: var(--bg); z-index: 2; cursor: pointer; transition: all 0.3s; }
        .flow-step-dot:hover, .flow-step.active .flow-step-dot { background: var(--primary); box-shadow: 0 0 12px var(--primary); }
        .flow-step-connector { width: 2px; flex: 1; background: var(--border); min-height: 30px; }
        .flow-step-body { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 16px 20px; flex: 1; margin-bottom: 12px; transition: border-color 0.3s; cursor: pointer; }
        .flow-step.active .flow-step-body { border-color: var(--primary); }
        .flow-step-body h4 { color: var(--primary-light); font-size: 0.95rem; margin-bottom: 4px; }
        .flow-step-body p { color: var(--text-muted); font-size: 0.85rem; margin: 0; }
        .flow-step-body .detail { display: none; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); color: var(--text); font-size: 0.85rem; }
        .flow-step.active .flow-step-body .detail { display: block; }
        .flow-step-body .method { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; font-weight: 700; margin-right: 6px; }
        .method-get { background: #166534; color: #86efac; }
        .method-post { background: #854d0e; color: #fde047; }
        .method-put { background: #1e40af; color: #93c5fd; }
        .method-delete { background: #991b1b; color: #fca5a5; }

        /* â”€â”€ API Table â”€â”€ */
        .api-table { width: 100%; border-collapse: collapse; margin-top: 16px; }
        .api-table th { background: var(--card); color: var(--accent); padding: 12px 16px; text-align: left; font-size: 0.85rem; border-bottom: 2px solid var(--primary); }
        .api-table td { padding: 10px 16px; border-bottom: 1px solid var(--border); font-size: 0.85rem; color: var(--text-muted); }
        .api-table tr:hover td { background: var(--card); color: var(--text); }
        .api-table .ep { color: var(--accent); font-family: 'Consolas', monospace; }

        /* â”€â”€ ER Diagram â”€â”€ */
        .er-wrapper { overflow-x: auto; }
        .er-table { background: var(--card); border: 2px solid var(--border); border-radius: 8px; display: inline-block; margin: 10px; vertical-align: top; min-width: 220px; }
        .er-table-header { background: var(--primary); color: white; padding: 10px 16px; font-weight: 700; text-align: center; border-radius: 6px 6px 0 0; font-size: 0.9rem; }
        .er-table-body { padding: 8px 0; }
        .er-field { padding: 5px 16px; font-size: 0.82rem; color: var(--text-muted); display: flex; justify-content: space-between; gap: 20px; }
        .er-field:hover { background: var(--surface); }
        .er-field .fname { color: var(--text); }
        .er-field .ftype { color: var(--accent); font-family: monospace; font-size: 0.78rem; }
        .er-field.pk { border-left: 3px solid var(--warning); }
        .er-field.fk { border-left: 3px solid var(--success); }
        .er-relations { display: flex; justify-content: center; align-items: center; gap: 10px; margin: 20px 0; flex-wrap: wrap; }
        .er-rel-arrow { color: var(--warning); font-size: 1.2rem; font-weight: 700; }
        .er-rel-label { background: var(--surface); border: 1px solid var(--border); padding: 6px 14px; border-radius: 6px; font-size: 0.8rem; color: var(--text-muted); }

        /* â”€â”€ Data Flow Diagram â”€â”€ */
        .data-flow { display: flex; align-items: center; justify-content: center; gap: 0; flex-wrap: wrap; padding: 20px 0; }
        .df-node { background: var(--card); border: 2px solid var(--border); border-radius: 10px; padding: 16px 20px; text-align: center; min-width: 130px; transition: all 0.3s; cursor: pointer; }
        .df-node:hover { border-color: var(--primary); transform: scale(1.05); }
        .df-node .df-icon { font-size: 1.8rem; margin-bottom: 6px; }
        .df-node .df-label { font-size: 0.85rem; font-weight: 600; color: var(--primary-light); }
        .df-node .df-desc { font-size: 0.72rem; color: var(--text-muted); margin-top: 4px; }
        .df-arrow { color: var(--accent); font-size: 1.5rem; padding: 0 8px; flex-shrink: 0; }

        /* â”€â”€ Project Structure â”€â”€ */
        .tree { font-family: 'Consolas', 'Courier New', monospace; font-size: 0.85rem; line-height: 1.8; }
        .tree-item { cursor: pointer; padding: 2px 4px; border-radius: 4px; transition: background 0.2s; }
        .tree-item:hover { background: var(--card); }
        .tree-folder { color: var(--warning); font-weight: 600; }
        .tree-file { color: var(--text-muted); }
        .tree-file-py { color: var(--success); }
        .tree-file-html { color: var(--danger); }
        .tree-file-js { color: var(--warning); }
        .tree-file-css { color: var(--primary-light); }
        .tree-desc { color: var(--text-muted); font-size: 0.75rem; font-style: italic; }
        .tree-children { padding-left: 24px; max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .tree-children.open { max-height: 2000px; }

        /* â”€â”€ Sequence Diagram â”€â”€ */
        .seq-diagram { display: flex; flex-direction: column; gap: 0; margin: 20px 0; }
        .seq-actors { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .seq-actor { text-align: center; flex: 1; }
        .seq-actor-box { display: inline-block; background: var(--primary); color: white; padding: 8px 18px; border-radius: 6px; font-size: 0.85rem; font-weight: 600; }
        .seq-lifeline { display: flex; justify-content: space-between; position: relative; min-height: 50px; align-items: center; }
        .seq-line { position: absolute; top: 50%; left: 0; right: 0; height: 1px; border-top: 1px dashed var(--border); }
        .seq-msg { position: relative; z-index: 2; background: var(--card); border: 1px solid var(--border); padding: 6px 14px; border-radius: 6px; font-size: 0.78rem; max-width: 240px; cursor: pointer; transition: border-color 0.2s; }
        .seq-msg:hover { border-color: var(--primary); }
        .seq-msg-label { font-weight: 600; color: var(--primary-light); }
        .seq-msg-detail { color: var(--text-muted); font-size: 0.72rem; }
        .seq-msg-arrow { color: var(--accent); font-size: 1rem; padding: 0 6px; }

        /* â”€â”€ Stats â”€â”€ */
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; margin-bottom: 30px; }
        .stat-card { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 20px; text-align: center; transition: transform 0.2s; }
        .stat-card:hover { transform: translateY(-2px); }
        .stat-number { font-size: 2rem; font-weight: 700; color: var(--primary-light); }
        .stat-label { font-size: 0.85rem; color: var(--text-muted); margin-top: 4px; }

        /* â”€â”€ Accordion â”€â”€ */
        .accordion { border: 1px solid var(--border); border-radius: 8px; overflow: hidden; margin-bottom: 16px; }
        .accordion-header { background: var(--card); padding: 14px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.2s; }
        .accordion-header:hover { background: var(--surface); }
        .accordion-header h4 { color: var(--primary-light); font-size: 0.95rem; }
        .accordion-arrow { color: var(--text-muted); transition: transform 0.3s; font-size: 1.2rem; }
        .accordion.open .accordion-arrow { transform: rotate(180deg); }
        .accordion-body { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; background: var(--surface); }
        .accordion.open .accordion-body { max-height: 2000px; }
        .accordion-body-inner { padding: 16px 20px; font-size: 0.88rem; color: var(--text-muted); line-height: 1.7; }
        .accordion-body-inner code { background: var(--bg); padding: 2px 6px; border-radius: 4px; color: var(--accent); font-size: 0.82rem; }

        /* â”€â”€ Tooltip â”€â”€ */
        .tip { position: relative; display: inline-block; border-bottom: 1px dotted var(--accent); cursor: help; }
        .tip .tip-text { visibility: hidden; background: var(--bg); color: var(--text); text-align: center; padding: 6px 12px; border-radius: 6px; border: 1px solid var(--primary); position: absolute; z-index: 10; bottom: 125%; left: 50%; transform: translateX(-50%); white-space: nowrap; font-size: 0.78rem; opacity: 0; transition: opacity 0.3s; }
        .tip:hover .tip-text { visibility: visible; opacity: 1; }

        @media (max-width: 768px) {
            .hero h1 { font-size: 1.8rem; }
            .tab-content { padding: 20px; }
            .data-flow { flex-direction: column; }
            .df-arrow { transform: rotate(90deg); }
        }
    </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HERO â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="hero">
    <h1>ğŸ¥ Healthcare Backend System</h1>
    <p>Complete architecture, API flows, data models, and technology overview â€” all in one interactive visual guide.</p>
    <div class="tech-badges">
        <span class="tech-badge">Python 3.11</span>
        <span class="tech-badge">Django 5.2</span>
        <span class="tech-badge">DRF 3.16</span>
        <span class="tech-badge">PostgreSQL</span>
        <span class="tech-badge">JWT Auth</span>
        <span class="tech-badge">REST API</span>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-nav">
    <button class="tab-btn active" onclick="switchTab('overview')">ğŸ“Š Overview</button>
    <button class="tab-btn" onclick="switchTab('architecture')">ğŸ—ï¸ Architecture</button>
    <button class="tab-btn" onclick="switchTab('auth-flow')">ğŸ” Auth Flow</button>
    <button class="tab-btn" onclick="switchTab('api-ref')">ğŸ“¡ API Reference</button>
    <button class="tab-btn" onclick="switchTab('data-model')">ğŸ—„ï¸ Data Model</button>
    <button class="tab-btn" onclick="switchTab('crud-flow')">ğŸ”„ CRUD Flows</button>
    <button class="tab-btn" onclick="switchTab('project-structure')">ğŸ“ Project Structure</button>
    <button class="tab-btn" onclick="switchTab('tech-stack')">âš™ï¸ Tech Deep Dive</button>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OVERVIEW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content active" id="tab-overview">
    <h2>Project Overview</h2>
    <p class="subtitle">A comprehensive backend for managing patients, doctors, and their assignments in a healthcare facility.</p>

    <div class="stat-grid">
        <div class="stat-card"><div class="stat-number">4</div><div class="stat-label">Django Apps</div></div>
        <div class="stat-card"><div class="stat-number">15</div><div class="stat-label">API Endpoints</div></div>
        <div class="stat-card"><div class="stat-number">4</div><div class="stat-label">Database Models</div></div>
        <div class="stat-card"><div class="stat-number">3</div><div class="stat-label">Auth Levels</div></div>
        <div class="stat-card"><div class="stat-number">5</div><div class="stat-label">Dependencies</div></div>
        <div class="stat-card"><div class="stat-number">7</div><div class="stat-label">Frontend Pages</div></div>
    </div>

    <div class="flow-container">
        <h3>ğŸŒ High-Level System Data Flow</h3>
        <div class="data-flow">
            <div class="df-node" onclick="this.classList.toggle('active')">
                <div class="df-icon">ğŸ‘¤</div>
                <div class="df-label">Client</div>
                <div class="df-desc">Browser / Postman</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node" onclick="this.classList.toggle('active')">
                <div class="df-icon">ğŸ”</div>
                <div class="df-label">JWT Auth</div>
                <div class="df-desc">Token Verification</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node" onclick="this.classList.toggle('active')">
                <div class="df-icon">ğŸŒ</div>
                <div class="df-label">DRF Views</div>
                <div class="df-desc">API Logic</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node" onclick="this.classList.toggle('active')">
                <div class="df-icon">ğŸ“‹</div>
                <div class="df-label">Serializers</div>
                <div class="df-desc">Validate &amp; Transform</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node" onclick="this.classList.toggle('active')">
                <div class="df-icon">ğŸ§©</div>
                <div class="df-label">Django ORM</div>
                <div class="df-desc">Model Layer</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node" onclick="this.classList.toggle('active')">
                <div class="df-icon">ğŸ˜</div>
                <div class="df-label">PostgreSQL</div>
                <div class="df-desc">Data Storage</div>
            </div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ“‹ Requirements Checklist</h3>
        <table class="api-table">
            <thead><tr><th>Requirement</th><th>Status</th><th>Implementation</th></tr></thead>
            <tbody>
                <tr><td>Django + DRF Backend</td><td style="color:#22c55e">âœ… Done</td><td>Django 5.2 + DRF 3.16</td></tr>
                <tr><td>PostgreSQL Database</td><td style="color:#22c55e">âœ… Done</td><td>psycopg2-binary, env-configured</td></tr>
                <tr><td>JWT Authentication</td><td style="color:#22c55e">âœ… Done</td><td>simplejwt (1h access, 1d refresh)</td></tr>
                <tr><td>RESTful API Endpoints</td><td style="color:#22c55e">âœ… Done</td><td>15 endpoints across 4 groups</td></tr>
                <tr><td>Django ORM Models</td><td style="color:#22c55e">âœ… Done</td><td>Patient, Doctor, PatientDoctorMapping</td></tr>
                <tr><td>Error Handling &amp; Validation</td><td style="color:#22c55e">âœ… Done</td><td>Serializer validation + 400/401/404</td></tr>
                <tr><td>Environment Variables</td><td style="color:#22c55e">âœ… Done</td><td>python-decouple with .env file</td></tr>
                <tr><td>Auth APIs (Register + Login)</td><td style="color:#22c55e">âœ… Done</td><td>accounts app</td></tr>
                <tr><td>Patient CRUD (5 endpoints)</td><td style="color:#22c55e">âœ… Done</td><td>patients app</td></tr>
                <tr><td>Doctor CRUD (5 endpoints)</td><td style="color:#22c55e">âœ… Done</td><td>doctors app</td></tr>
                <tr><td>Patient-Doctor Mappings (4 endpoints)</td><td style="color:#22c55e">âœ… Done</td><td>mappings app</td></tr>
                <tr><td>Authenticated-only endpoints</td><td style="color:#22c55e">âœ… Done</td><td>IsAuthenticated permission class</td></tr>
                <tr><td>Frontend UI</td><td style="color:#22c55e">âœ… Bonus</td><td>Vanilla JS SPA with 7 pages</td></tr>
            </tbody>
        </table>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ARCHITECTURE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-architecture">
    <h2>System Architecture</h2>
    <p class="subtitle">How the Django apps, middleware, and database layers fit together.</p>

    <div class="flow-container">
        <h3>ğŸ§± Layered Architecture</h3>
        <div class="data-flow" style="flex-direction: column; gap: 0;">
            <div class="df-node" style="width: 90%; max-width: 600px; border-color: var(--accent);">
                <div class="df-label" style="font-size: 1rem;">ğŸ–¥ï¸ Presentation Layer</div>
                <div class="df-desc">Django Templates (base.html, app_base.html) + Static Files (app.js, style.css)<br>Vanilla JS SPA â€” localStorage JWT â€” Fetch API calls</div>
            </div>
            <div class="df-arrow" style="padding: 10px; transform: rotate(90deg);">â†’</div>
            <div class="df-node" style="width: 90%; max-width: 600px; border-color: var(--primary);">
                <div class="df-label" style="font-size: 1rem;">ğŸŒ API Layer (Django REST Framework)</div>
                <div class="df-desc">APIView classes â€” JWT Authentication middleware<br>RegisterView, LoginView, PatientListCreateView, DoctorListCreateView, MappingListCreateView</div>
            </div>
            <div class="df-arrow" style="padding: 10px; transform: rotate(90deg);">â†’</div>
            <div class="df-node" style="width: 90%; max-width: 600px; border-color: var(--success);">
                <div class="df-label" style="font-size: 1rem;">ğŸ“‹ Serialization Layer</div>
                <div class="df-desc">RegisterSerializer, LoginSerializer, PatientSerializer<br>DoctorSerializer, MappingSerializer, MappingDetailSerializer</div>
            </div>
            <div class="df-arrow" style="padding: 10px; transform: rotate(90deg);">â†’</div>
            <div class="df-node" style="width: 90%; max-width: 600px; border-color: var(--warning);">
                <div class="df-label" style="font-size: 1rem;">ğŸ§© Model / ORM Layer</div>
                <div class="df-desc">User (Django built-in), Patient, Doctor, PatientDoctorMapping<br>ForeignKey relations   â€¢   unique_together constraints   â€¢   auto timestamps</div>
            </div>
            <div class="df-arrow" style="padding: 10px; transform: rotate(90deg);">â†’</div>
            <div class="df-node" style="width: 90%; max-width: 600px; border-color: var(--danger);">
                <div class="df-label" style="font-size: 1rem;">ğŸ˜ Database Layer (PostgreSQL)</div>
                <div class="df-desc">auth_user, patients_patient, doctors_doctor, mappings_patientdoctormapping<br>Managed by Django Migrations</div>
            </div>
        </div>
    </div>

    <div class="arch-grid">
        <div class="arch-card">
            <div class="icon">ğŸ”</div>
            <h4>accounts app</h4>
            <p>User registration &amp; JWT login. Uses Django's built-in <code>User</code> model. Issues access + refresh tokens via <code>simplejwt</code>.</p>
        </div>
        <div class="arch-card">
            <div class="icon">ğŸ¥</div>
            <h4>patients app</h4>
            <p>Full CRUD for patient records. Scoped to the authenticated user via <code>created_by</code> ForeignKey. Fields: name, age, gender, phone, address, medical_history.</p>
        </div>
        <div class="arch-card">
            <div class="icon">ğŸ‘¨â€âš•ï¸</div>
            <h4>doctors app</h4>
            <p>Full CRUD for doctor records. All doctors visible to all users. Fields: name, specialization, phone, email, experience_years.</p>
        </div>
        <div class="arch-card">
            <div class="icon">ğŸ”—</div>
            <h4>mappings app</h4>
            <p>Assigns doctors to patients (many-to-many through table). Prevents duplicates via <code>unique_together</code>. Supports list, filter-by-patient, and delete.</p>
        </div>
        <div class="arch-card">
            <div class="icon">ğŸ–¥ï¸</div>
            <h4>frontend app</h4>
            <p>Vanilla JS single-page application. Template-rendered pages with AJAX calls to the DRF API. JWT stored in <code>localStorage</code>.</p>
        </div>
        <div class="arch-card">
            <div class="icon">âš™ï¸</div>
            <h4>healthcare (config)</h4>
            <p>Root Django project. Contains <code>settings.py</code> (database, JWT config, installed apps), URL routing, WSGI/ASGI entry points.</p>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ”Œ URL Routing Map</h3>
        <table class="api-table">
            <thead><tr><th>URL Pattern</th><th>App</th><th>Handler</th></tr></thead>
            <tbody>
                <tr><td class="ep">/admin/</td><td>Django Admin</td><td>Built-in admin site</td></tr>
                <tr><td class="ep">/api/auth/*</td><td>accounts</td><td>RegisterView, LoginView</td></tr>
                <tr><td class="ep">/api/patients/*</td><td>patients</td><td>PatientListCreateView, PatientDetailView</td></tr>
                <tr><td class="ep">/api/doctors/*</td><td>doctors</td><td>DoctorListCreateView, DoctorDetailView</td></tr>
                <tr><td class="ep">/api/mappings/*</td><td>mappings</td><td>MappingListCreateView, MappingByPatientView, MappingDeleteView</td></tr>
                <tr><td class="ep">/*</td><td>frontend</td><td>Template views (login, register, dashboard, etc.)</td></tr>
            </tbody>
        </table>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUTH FLOW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-auth-flow">
    <h2>Authentication Flow</h2>
    <p class="subtitle">JWT-based authentication using djangorestframework-simplejwt.</p>

    <div class="flow-container">
        <h3>ğŸ“ Registration Flow</h3>
        <div class="flow-steps">
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4><span class="method method-post">POST</span> /api/auth/register/</h4>
                    <p>Client sends username, email, and password</p>
                    <div class="detail">
                        <strong>Request Body:</strong><br>
                        <code>{ "username": "john", "email": "john@mail.com", "password": "Pass@1234" }</code><br><br>
                        <strong>Validations:</strong>
                        <ul style="margin-left:20px; margin-top:6px;">
                            <li>Email uniqueness check (serializer-level)</li>
                            <li>Password min length: 8 characters</li>
                            <li>Username uniqueness (Django model-level)</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4>ğŸ” RegisterSerializer validates input</h4>
                    <p>Checks email uniqueness, password length, and username availability</p>
                    <div class="detail">
                        <code>RegisterSerializer</code> extends <code>ModelSerializer</code> on Django's <code>User</code> model.<br>
                        Custom <code>validate_email()</code> checks <code>User.objects.filter(email=value).exists()</code>.<br>
                        Password field: <code>write_only=True, min_length=8</code>.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4>ğŸ’¾ User.objects.create_user()</h4>
                    <p>Django creates user with hashed password in PostgreSQL</p>
                    <div class="detail">
                        Uses Django's built-in <code>create_user()</code> method which automatically hashes the password using PBKDF2-SHA256. Entry is written to <code>auth_user</code> table.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div></div>
                <div class="flow-step-body">
                    <h4>âœ… 201 Created â€” User object returned</h4>
                    <p>Response: id, username, email (no password)</p>
                    <div class="detail">
                        <code>{ "message": "User registered successfully.", "user": { "id": 1, "username": "john", "email": "john@mail.com" } }</code>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ”‘ Login Flow</h3>
        <div class="flow-steps">
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4><span class="method method-post">POST</span> /api/auth/login/</h4>
                    <p>Client sends email and password</p>
                    <div class="detail">
                        <code>{ "email": "john@mail.com", "password": "Pass@1234" }</code><br><br>
                        Note: Login is email-based, not username-based. The view looks up the username from the email first.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4>ğŸ” Lookup user by email â†’ authenticate()</h4>
                    <p>Django's authenticate() verifies credentials against hashed password</p>
                    <div class="detail">
                        <code>User.objects.get(email=email)</code> â†’ gets the username<br>
                        <code>authenticate(username=..., password=...)</code> â†’ verifies against DB hash.<br>
                        Returns 401 if email not found or password doesn't match.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4>ğŸŸï¸ RefreshToken.for_user(user)</h4>
                    <p>simplejwt generates access token (1h) and refresh token (1d)</p>
                    <div class="detail">
                        Access token: short-lived (1 hour), sent in <code>Authorization: Bearer &lt;token&gt;</code> header.<br>
                        Refresh token: longer-lived (1 day), used to get a new access token without re-login.<br>
                        Both are <strong>signed JWTs</strong> containing user ID and expiration.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div></div>
                <div class="flow-step-body">
                    <h4>âœ… 200 OK â€” Tokens returned</h4>
                    <p>Client stores access + refresh tokens in localStorage</p>
                    <div class="detail">
                        <code>{ "message": "Login successful.", "user": { "id": 1, ... }, "tokens": { "access": "eyJ...", "refresh": "eyJ..." } }</code><br><br>
                        Frontend JS stores tokens via <code>setTokens(access, refresh)</code> and redirects to dashboard.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ›¡ï¸ Authenticated Request Flow</h3>
        <div class="data-flow">
            <div class="df-node">
                <div class="df-icon">ğŸ“¤</div>
                <div class="df-label">Request</div>
                <div class="df-desc">Authorization: Bearer &lt;JWT&gt;</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node">
                <div class="df-icon">ğŸ›¡ï¸</div>
                <div class="df-label">JWTAuthentication</div>
                <div class="df-desc">Decode &amp; verify token</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node">
                <div class="df-icon">âœ…</div>
                <div class="df-label">IsAuthenticated</div>
                <div class="df-desc">Permission check</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node">
                <div class="df-icon">âš¡</div>
                <div class="df-label">APIView</div>
                <div class="df-desc">request.user available</div>
            </div>
            <div class="df-arrow">â†’</div>
            <div class="df-node">
                <div class="df-icon">ğŸ“¥</div>
                <div class="df-label">Response</div>
                <div class="df-desc">JSON data returned</div>
            </div>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• API REFERENCE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-api-ref">
    <h2>API Reference</h2>
    <p class="subtitle">Complete list of all 15 RESTful API endpoints.</p>

    <div class="flow-container">
        <h3>ğŸ” Authentication APIs</h3>
        <table class="api-table">
            <thead><tr><th>Method</th><th>Endpoint</th><th>Description</th><th>Auth</th></tr></thead>
            <tbody>
                <tr><td><span class="method method-post">POST</span></td><td class="ep">/api/auth/register/</td><td>Register new user (name, email, password)</td><td>âŒ Public</td></tr>
                <tr><td><span class="method method-post">POST</span></td><td class="ep">/api/auth/login/</td><td>Login â†’ returns JWT access + refresh tokens</td><td>âŒ Public</td></tr>
            </tbody>
        </table>
    </div>

    <div class="flow-container">
        <h3>ğŸ¥ Patient Management APIs</h3>
        <table class="api-table">
            <thead><tr><th>Method</th><th>Endpoint</th><th>Description</th><th>Auth</th></tr></thead>
            <tbody>
                <tr><td><span class="method method-post">POST</span></td><td class="ep">/api/patients/</td><td>Add a new patient</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-get">GET</span></td><td class="ep">/api/patients/</td><td>List all patients (created by logged-in user)</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-get">GET</span></td><td class="ep">/api/patients/&lt;id&gt;/</td><td>Get specific patient details</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-put">PUT</span></td><td class="ep">/api/patients/&lt;id&gt;/</td><td>Update patient record</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-delete">DELETE</span></td><td class="ep">/api/patients/&lt;id&gt;/</td><td>Delete patient record</td><td>ğŸ”’ Required</td></tr>
            </tbody>
        </table>
    </div>

    <div class="flow-container">
        <h3>ğŸ‘¨â€âš•ï¸ Doctor Management APIs</h3>
        <table class="api-table">
            <thead><tr><th>Method</th><th>Endpoint</th><th>Description</th><th>Auth</th></tr></thead>
            <tbody>
                <tr><td><span class="method method-post">POST</span></td><td class="ep">/api/doctors/</td><td>Add a new doctor</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-get">GET</span></td><td class="ep">/api/doctors/</td><td>List all doctors (visible to all users)</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-get">GET</span></td><td class="ep">/api/doctors/&lt;id&gt;/</td><td>Get specific doctor details</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-put">PUT</span></td><td class="ep">/api/doctors/&lt;id&gt;/</td><td>Update doctor record</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-delete">DELETE</span></td><td class="ep">/api/doctors/&lt;id&gt;/</td><td>Delete doctor record</td><td>ğŸ”’ Required</td></tr>
            </tbody>
        </table>
    </div>

    <div class="flow-container">
        <h3>ğŸ”— Patient-Doctor Mapping APIs</h3>
        <table class="api-table">
            <thead><tr><th>Method</th><th>Endpoint</th><th>Description</th><th>Auth</th></tr></thead>
            <tbody>
                <tr><td><span class="method method-post">POST</span></td><td class="ep">/api/mappings/</td><td>Assign a doctor to a patient</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-get">GET</span></td><td class="ep">/api/mappings/</td><td>List all patient-doctor mappings</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-get">GET</span></td><td class="ep">/api/mappings/patient/&lt;patient_id&gt;/</td><td>Get all doctors assigned to a patient</td><td>ğŸ”’ Required</td></tr>
                <tr><td><span class="method method-delete">DELETE</span></td><td class="ep">/api/mappings/&lt;id&gt;/</td><td>Remove a doctor-patient assignment</td><td>ğŸ”’ Required</td></tr>
            </tbody>
        </table>
    </div>

    <div class="flow-container">
        <h3>ğŸ“ Sample Request / Response</h3>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>POST /api/auth/register/ â€” Register User</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                <strong>Request:</strong><br>
                <code>POST /api/auth/register/</code><br>
                <code>Content-Type: application/json</code><br><br>
                <code>{ "username": "newuser", "email": "new@mail.com", "password": "Secure@123" }</code><br><br>
                <strong>Success Response (201):</strong><br>
                <code>{ "message": "User registered successfully.", "user": { "id": 4, "username": "newuser", "email": "new@mail.com" } }</code><br><br>
                <strong>Error Response (400):</strong><br>
                <code>{ "email": ["A user with this email already exists."] }</code>
            </div></div>
        </div>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>POST /api/auth/login/ â€” Login</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                <strong>Request:</strong><br>
                <code>{ "email": "admin@healthcare.com", "password": "Admin@1234" }</code><br><br>
                <strong>Success Response (200):</strong><br>
                <code>{ "message": "Login successful.", "user": { "id": 1, ... }, "tokens": { "access": "eyJ...", "refresh": "eyJ..." } }</code>
            </div></div>
        </div>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>POST /api/patients/ â€” Create Patient</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                <strong>Headers:</strong> <code>Authorization: Bearer &lt;access_token&gt;</code><br><br>
                <strong>Request:</strong><br>
                <code>{ "name": "John Doe", "age": 35, "gender": "Male", "phone": "+91-999", "address": "Street 1", "medical_history": "None" }</code><br><br>
                <strong>Success Response (201):</strong><br>
                <code>{ "id": 1, "name": "John Doe", "age": 35, "gender": "Male", ... }</code>
            </div></div>
        </div>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>POST /api/mappings/ â€” Assign Doctor to Patient</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                <strong>Headers:</strong> <code>Authorization: Bearer &lt;access_token&gt;</code><br><br>
                <strong>Request:</strong><br>
                <code>{ "patient": 1, "doctor": 3 }</code><br><br>
                <strong>Success Response (201):</strong><br>
                <code>{ "id": 1, "patient": 1, "doctor": 3, "assigned_at": "2026-02-25T..." }</code><br><br>
                <strong>Duplicate Error (400):</strong><br>
                <code>{ "error": "This doctor is already assigned to this patient." }</code>
            </div></div>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATA MODEL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-data-model">
    <h2>Data Model (ER Diagram)</h2>
    <p class="subtitle">Entity-Relationship diagram showing all database tables and their connections.</p>

    <div class="flow-container">
        <h3>ğŸ“Š Entity-Relationship Diagram</h3>
        <div class="er-wrapper" style="text-align: center;">
            <div style="display: inline-flex; flex-wrap: wrap; gap: 30px; justify-content: center; align-items: flex-start;">
                <!-- User Table -->
                <div class="er-table">
                    <div class="er-table-header">ğŸ‘¤ auth_user (Django Built-in)</div>
                    <div class="er-table-body">
                        <div class="er-field pk"><span class="fname">ğŸ”‘ id</span><span class="ftype">BigAutoField PK</span></div>
                        <div class="er-field"><span class="fname">username</span><span class="ftype">CharField(150)</span></div>
                        <div class="er-field"><span class="fname">email</span><span class="ftype">EmailField</span></div>
                        <div class="er-field"><span class="fname">password</span><span class="ftype">CharField (hashed)</span></div>
                        <div class="er-field"><span class="fname">is_active</span><span class="ftype">BooleanField</span></div>
                        <div class="er-field"><span class="fname">date_joined</span><span class="ftype">DateTimeField</span></div>
                    </div>
                </div>

                <!-- Patient Table -->
                <div class="er-table">
                    <div class="er-table-header">ğŸ¥ patients_patient</div>
                    <div class="er-table-body">
                        <div class="er-field pk"><span class="fname">ğŸ”‘ id</span><span class="ftype">BigAutoField PK</span></div>
                        <div class="er-field fk"><span class="fname">ğŸ”— created_by_id</span><span class="ftype">FK â†’ auth_user</span></div>
                        <div class="er-field"><span class="fname">name</span><span class="ftype">CharField(200)</span></div>
                        <div class="er-field"><span class="fname">age</span><span class="ftype">PositiveIntegerField</span></div>
                        <div class="er-field"><span class="fname">gender</span><span class="ftype">CharField(10)</span></div>
                        <div class="er-field"><span class="fname">phone</span><span class="ftype">CharField(15)</span></div>
                        <div class="er-field"><span class="fname">address</span><span class="ftype">TextField</span></div>
                        <div class="er-field"><span class="fname">medical_history</span><span class="ftype">TextField</span></div>
                        <div class="er-field"><span class="fname">created_at</span><span class="ftype">DateTimeField</span></div>
                        <div class="er-field"><span class="fname">updated_at</span><span class="ftype">DateTimeField</span></div>
                    </div>
                </div>

                <!-- Doctor Table -->
                <div class="er-table">
                    <div class="er-table-header">ğŸ‘¨â€âš•ï¸ doctors_doctor</div>
                    <div class="er-table-body">
                        <div class="er-field pk"><span class="fname">ğŸ”‘ id</span><span class="ftype">BigAutoField PK</span></div>
                        <div class="er-field fk"><span class="fname">ğŸ”— created_by_id</span><span class="ftype">FK â†’ auth_user</span></div>
                        <div class="er-field"><span class="fname">name</span><span class="ftype">CharField(200)</span></div>
                        <div class="er-field"><span class="fname">specialization</span><span class="ftype">CharField(200)</span></div>
                        <div class="er-field"><span class="fname">phone</span><span class="ftype">CharField(15)</span></div>
                        <div class="er-field"><span class="fname">email</span><span class="ftype">EmailField</span></div>
                        <div class="er-field"><span class="fname">experience_years</span><span class="ftype">PositiveIntegerField</span></div>
                        <div class="er-field"><span class="fname">created_at</span><span class="ftype">DateTimeField</span></div>
                        <div class="er-field"><span class="fname">updated_at</span><span class="ftype">DateTimeField</span></div>
                    </div>
                </div>

                <!-- Mapping Table -->
                <div class="er-table">
                    <div class="er-table-header" style="background: var(--warning);">ğŸ”— mappings_patientdoctormapping</div>
                    <div class="er-table-body">
                        <div class="er-field pk"><span class="fname">ğŸ”‘ id</span><span class="ftype">BigAutoField PK</span></div>
                        <div class="er-field fk"><span class="fname">ğŸ”— patient_id</span><span class="ftype">FK â†’ patients_patient</span></div>
                        <div class="er-field fk"><span class="fname">ğŸ”— doctor_id</span><span class="ftype">FK â†’ doctors_doctor</span></div>
                        <div class="er-field"><span class="fname">assigned_at</span><span class="ftype">DateTimeField</span></div>
                        <div class="er-field" style="border-left: 3px solid var(--danger);"><span class="fname">âš ï¸ unique_together</span><span class="ftype">(patient, doctor)</span></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="er-relations" style="margin-top: 30px;">
            <span class="er-rel-label">auth_user</span>
            <span class="er-rel-arrow">1 â”€â”€â”€â”€ âˆ</span>
            <span class="er-rel-label">patients_patient</span>
            <span style="color: var(--text-muted); padding: 0 15px;">|</span>
            <span class="er-rel-label">auth_user</span>
            <span class="er-rel-arrow">1 â”€â”€â”€â”€ âˆ</span>
            <span class="er-rel-label">doctors_doctor</span>
            <span style="color: var(--text-muted); padding: 0 15px;">|</span>
            <span class="er-rel-label">patient</span>
            <span class="er-rel-arrow">âˆ â”€â”€â”€â”€ âˆ</span>
            <span class="er-rel-label">doctor</span>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ”— Relationship Details</h3>
        <div class="arch-grid">
            <div class="arch-card">
                <h4>User â†’ Patient (1:N)</h4>
                <p>Each user can create multiple patients. Patients are scoped to their creator â€” GET only returns patients where <code>created_by = request.user</code>.</p>
            </div>
            <div class="arch-card">
                <h4>User â†’ Doctor (1:N)</h4>
                <p>Each user can create multiple doctors. However, GET returns <strong>all</strong> doctors regardless of creator â€” doctors are a shared resource.</p>
            </div>
            <div class="arch-card">
                <h4>Patient â†” Doctor (M:N)</h4>
                <p>Many-to-many via <code>PatientDoctorMapping</code> join table. A patient can have multiple doctors and vice versa. <code>unique_together</code> prevents duplicate assignments.</p>
            </div>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CRUD FLOWS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-crud-flow">
    <h2>CRUD Operation Flows</h2>
    <p class="subtitle">Step-by-step flows for Create, Read, Update, and Delete operations.</p>

    <div class="flow-container">
        <h3>â• Create Flow (POST)</h3>
        <div class="data-flow">
            <div class="df-node"><div class="df-icon">ğŸ“</div><div class="df-label">Client Form</div><div class="df-desc">User fills form data</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ“¤</div><div class="df-label">POST Request</div><div class="df-desc">+ Bearer JWT Header</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">âœ…</div><div class="df-label">Serializer</div><div class="df-desc">is_valid() check</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ’¾</div><div class="df-label">.save()</div><div class="df-desc">created_by=user</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">âœ…</div><div class="df-label">201 Created</div><div class="df-desc">Object returned</div></div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ“– Read Flow (GET)</h3>
        <div class="data-flow">
            <div class="df-node"><div class="df-icon">ğŸ‘¤</div><div class="df-label">Client</div><div class="df-desc">GET request</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ›¡ï¸</div><div class="df-label">Auth Check</div><div class="df-desc">JWT verified</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ”</div><div class="df-label">QuerySet</div><div class="df-desc">Filter by user/all</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ“‹</div><div class="df-label">Serialize</div><div class="df-desc">Model â†’ JSON</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ“¥</div><div class="df-label">200 OK</div><div class="df-desc">JSON response</div></div>
        </div>
        <div style="margin-top: 16px; padding: 12px; background: var(--bg); border-radius: 6px; font-size: 0.85rem; color: var(--text-muted);">
            <strong style="color: var(--warning)">Note:</strong> Patients are filtered by <code>created_by=request.user</code> (user sees only their own). Doctors return <code>Doctor.objects.all()</code> (shared across users).
        </div>
    </div>

    <div class="flow-container">
        <h3>âœï¸ Update Flow (PUT)</h3>
        <div class="data-flow">
            <div class="df-node"><div class="df-icon">ğŸ“</div><div class="df-label">Edit Form</div><div class="df-desc">Modified fields</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ“¤</div><div class="df-label">PUT /&lt;id&gt;/</div><div class="df-desc">Full object body</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ”</div><div class="df-label">get_object()</div><div class="df-desc">404 if not found</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">âœ…</div><div class="df-label">Validate</div><div class="df-desc">Serializer check</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ’¾</div><div class="df-label">.save()</div><div class="df-desc">200 OK</div></div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ—‘ï¸ Delete Flow (DELETE)</h3>
        <div class="data-flow">
            <div class="df-node"><div class="df-icon">âš ï¸</div><div class="df-label">Confirm</div><div class="df-desc">User confirms</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ“¤</div><div class="df-label">DELETE /&lt;id&gt;/</div><div class="df-desc">JWT auth header</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ”</div><div class="df-label">get_object()</div><div class="df-desc">404 if not found</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">ğŸ—‘ï¸</div><div class="df-label">.delete()</div><div class="df-desc">Cascade removes mappings</div></div>
            <div class="df-arrow">â†’</div>
            <div class="df-node"><div class="df-icon">âœ…</div><div class="df-label">204 No Content</div><div class="df-desc">Record removed</div></div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ”— Patient-Doctor Mapping Flow</h3>
        <div class="flow-steps">
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4><span class="method method-post">POST</span> /api/mappings/</h4>
                    <p>Assign doctor to patient â€” send patient ID and doctor ID</p>
                    <div class="detail">
                        Request: <code>{ "patient": 1, "doctor": 3 }</code><br>
                        Checks if mapping already exists (unique_together). Returns 400 if duplicate.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4><span class="method method-get">GET</span> /api/mappings/</h4>
                    <p>List all mappings with nested patient and doctor details</p>
                    <div class="detail">
                        Uses <code>MappingDetailSerializer</code> which includes full <code>PatientSerializer</code> and <code>DoctorSerializer</code> as nested objects instead of just IDs.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div><div class="flow-step-connector"></div></div>
                <div class="flow-step-body">
                    <h4><span class="method method-get">GET</span> /api/mappings/patient/&lt;patient_id&gt;/</h4>
                    <p>Get all doctors assigned to a specific patient</p>
                    <div class="detail">
                        Filters <code>PatientDoctorMapping.objects.filter(patient_id=patient_id)</code>.<br>
                        Returns nested patient and doctor details for each mapping.
                    </div>
                </div>
            </div>
            <div class="flow-step" onclick="toggleStep(this)">
                <div class="flow-step-line"><div class="flow-step-dot"></div></div>
                <div class="flow-step-body">
                    <h4><span class="method method-delete">DELETE</span> /api/mappings/&lt;id&gt;/</h4>
                    <p>Remove a specific doctor-patient assignment by mapping ID</p>
                    <div class="detail">
                        Finds mapping by PK with <code>get_object_or_404</code>. Deletes the row from <code>PatientDoctorMapping</code> table. Returns 204.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROJECT STRUCTURE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-project-structure">
    <h2>Project Structure</h2>
    <p class="subtitle">Interactive file tree with descriptions. Click folders to expand/collapse.</p>

    <div class="flow-container">
        <div class="tree" id="project-tree"></div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TECH DEEP DIVE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="tab-content" id="tab-tech-stack">
    <h2>Technology Deep Dive</h2>
    <p class="subtitle">Detailed breakdown of every technology used in this project.</p>

    <div class="arch-grid">
        <div class="arch-card" style="border-left: 4px solid #22c55e;">
            <div class="icon">ğŸ</div>
            <h4>Python 3.11</h4>
            <p>Core programming language. Used for all backend logic, ORM models, serializers, and views. Type hinting supported but not used in this project.</p>
        </div>
        <div class="arch-card" style="border-left: 4px solid #22c55e;">
            <div class="icon">ğŸ¯</div>
            <h4>Django 5.2</h4>
            <p>High-level Python web framework. Provides ORM, admin panel, URL routing, template engine, middleware pipeline, and authentication system. Follows MTV (Model-Template-View) pattern.</p>
        </div>
        <div class="arch-card" style="border-left: 4px solid #ef4444;">
            <div class="icon">ğŸŒ</div>
            <h4>Django REST Framework 3.16</h4>
            <p>Toolkit for building Web APIs. Provides <code>APIView</code>, <code>Serializer</code>, authentication backends, permission classes, and automatic content negotiation.</p>
        </div>
        <div class="arch-card" style="border-left: 4px solid #f59e0b;">
            <div class="icon">ğŸŸï¸</div>
            <h4>SimpleJWT 5.5</h4>
            <p>JWT authentication for DRF. Generates signed access tokens (1h TTL) and refresh tokens (1d TTL). Tokens contain user ID and expiration claims.</p>
        </div>
        <div class="arch-card" style="border-left: 4px solid #3b82f6;">
            <div class="icon">ğŸ˜</div>
            <h4>PostgreSQL</h4>
            <p>Robust open-source relational database. ACID-compliant, supports foreign keys, unique constraints, and complex queries. Connected via <code>psycopg2-binary</code>.</p>
        </div>
        <div class="arch-card" style="border-left: 4px solid #8b5cf6;">
            <div class="icon">ğŸ”§</div>
            <h4>python-decouple</h4>
            <p>Separates settings from code. Reads <code>SECRET_KEY</code>, <code>DB_*</code> credentials, and <code>DEBUG</code> flag from <code>.env</code> file. Prevents secrets in source code.</p>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ“¦ Dependencies (requirements.txt)</h3>
        <table class="api-table">
            <thead><tr><th>Package</th><th>Version</th><th>Purpose</th></tr></thead>
            <tbody>
                <tr><td><code>Django</code></td><td>5.2.11</td><td>Web framework â€” ORM, routing, templates, admin</td></tr>
                <tr><td><code>djangorestframework</code></td><td>3.16.1</td><td>REST API toolkit â€” serializers, views, permissions</td></tr>
                <tr><td><code>djangorestframework-simplejwt</code></td><td>5.5.1</td><td>JWT token authentication</td></tr>
                <tr><td><code>psycopg2-binary</code></td><td>2.9.11</td><td>PostgreSQL database adapter for Python</td></tr>
                <tr><td><code>python-decouple</code></td><td>3.8</td><td>Environment variable management (.env files)</td></tr>
            </tbody>
        </table>
    </div>

    <div class="flow-container">
        <h3>âš™ï¸ Django Settings Breakdown</h3>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>REST_FRAMEWORK Configuration</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                <code>DEFAULT_AUTHENTICATION_CLASSES</code>: <code>JWTAuthentication</code> â€” all views use JWT by default.<br><br>
                <code>DEFAULT_PERMISSION_CLASSES</code>: <code>IsAuthenticated</code> â€” all views require auth by default. Public views (register, login) override with <code>AllowAny</code>.
            </div></div>
        </div>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>SIMPLE_JWT Configuration</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                <code>ACCESS_TOKEN_LIFETIME</code>: 1 hour â€” short-lived for security.<br>
                <code>REFRESH_TOKEN_LIFETIME</code>: 1 day â€” used to get new access tokens.<br>
                <code>AUTH_HEADER_TYPES</code>: <code>('Bearer',)</code> â€” tokens sent as <code>Authorization: Bearer &lt;token&gt;</code>.
            </div></div>
        </div>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>Database Configuration</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                Engine: <code>django.db.backends.postgresql</code><br>
                All credentials loaded from environment variables via <code>python-decouple</code>:<br>
                <code>DB_NAME</code>, <code>DB_USER</code>, <code>DB_PASSWORD</code>, <code>DB_HOST</code>, <code>DB_PORT</code><br><br>
                Defaults provided for local development: <code>healthcare_db</code> / <code>postgres</code> / <code>localhost:5432</code>
            </div></div>
        </div>
        <div class="accordion" onclick="this.classList.toggle('open')">
            <div class="accordion-header"><h4>Middleware Pipeline</h4><span class="accordion-arrow">â–¼</span></div>
            <div class="accordion-body"><div class="accordion-body-inner">
                Request flows through 7 middleware layers in order:<br><br>
                1. <code>SecurityMiddleware</code> â€” HTTPS redirects, HSTS headers<br>
                2. <code>SessionMiddleware</code> â€” session management<br>
                3. <code>CommonMiddleware</code> â€” URL normalization, Content-Length<br>
                4. <code>CsrfViewMiddleware</code> â€” CSRF protection for form submissions<br>
                5. <code>AuthenticationMiddleware</code> â€” attaches user to request<br>
                6. <code>MessageMiddleware</code> â€” one-time notification messages<br>
                7. <code>XFrameOptionsMiddleware</code> â€” clickjacking protection
            </div></div>
        </div>
    </div>

    <div class="flow-container">
        <h3>ğŸ–¥ï¸ Frontend Technology</h3>
        <div class="arch-grid">
            <div class="arch-card">
                <div class="icon">ğŸ“„</div>
                <h4>Django Templates</h4>
                <p>Server-side HTML rendering with <code>{% extends %}</code>, <code>{% block %}</code>, <code>{% load static %}</code>. Two base templates: <code>base.html</code> (auth pages) and <code>app_base.html</code> (dashboard pages with navbar).</p>
            </div>
            <div class="arch-card">
                <div class="icon">âš¡</div>
                <h4>Vanilla JavaScript</h4>
                <p>No framework â€” pure ES6+ JS. <code>app.js</code> provides <code>apiRequest()</code> helper, token management, and alert system. Each page has inline <code>&lt;script&gt;</code> for CRUD operations.</p>
            </div>
            <div class="arch-card">
                <div class="icon">ğŸ¨</div>
                <h4>Custom CSS</h4>
                <p>339 lines of hand-written CSS. Includes: CSS custom properties (variables), responsive grid, cards, modals, tables, form styling, and alert animations.</p>
            </div>
            <div class="arch-card">
                <div class="icon">ğŸ’¾</div>
                <h4>localStorage</h4>
                <p>JWT tokens stored client-side: <code>access_token</code>, <code>refresh_token</code>, <code>username</code>. Cleared on logout or 401 response. Auth guard: <code>isLoggedIn()</code> check on protected pages.</p>
            </div>
        </div>
    </div>
</div>

<script>
    // â”€â”€ Tab Switching â”€â”€
    function switchTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-' + tabId).classList.add('active');
        event.target.classList.add('active');
    }

    // â”€â”€ Flow Step Toggle â”€â”€
    function toggleStep(el) {
        el.classList.toggle('active');
    }

    // â”€â”€ Project Tree â”€â”€
    const treeData = [
        { name: 'health-care/', type: 'folder', desc: 'Project Root', children: [
            { name: 'manage.py', type: 'py', desc: 'Django CLI entry point' },
            { name: 'requirements.txt', type: 'file', desc: '5 Python dependencies' },
            { name: 'README.md', type: 'file', desc: 'Project documentation' },
            { name: '.env', type: 'file', desc: 'Environment variables (gitignored)' },
            { name: 'healthcare/', type: 'folder', desc: 'Django Project Config', children: [
                { name: 'settings.py', type: 'py', desc: 'Database, JWT, DRF, middleware config' },
                { name: 'urls.py', type: 'py', desc: 'Root URL routing â†’ 5 includes' },
                { name: 'wsgi.py', type: 'py', desc: 'WSGI entry point (production)' },
                { name: 'asgi.py', type: 'py', desc: 'ASGI entry point (async)' },
            ]},
            { name: 'accounts/', type: 'folder', desc: 'Auth App â€” Register + Login', children: [
                { name: 'models.py', type: 'py', desc: 'Uses Django built-in User model' },
                { name: 'serializers.py', type: 'py', desc: 'RegisterSerializer, LoginSerializer' },
                { name: 'views.py', type: 'py', desc: 'RegisterView, LoginView (AllowAny)' },
                { name: 'urls.py', type: 'py', desc: 'register/, login/' },
                { name: 'admin.py', type: 'py', desc: 'Default User admin' },
            ]},
            { name: 'patients/', type: 'folder', desc: 'Patient CRUD App', children: [
                { name: 'models.py', type: 'py', desc: 'Patient model (8 fields + created_by FK)' },
                { name: 'serializers.py', type: 'py', desc: 'PatientSerializer (ModelSerializer)' },
                { name: 'views.py', type: 'py', desc: 'PatientListCreateView + PatientDetailView' },
                { name: 'urls.py', type: 'py', desc: '"", "<int:pk>/"' },
                { name: 'admin.py', type: 'py', desc: 'Admin with list_display, search, filter' },
                { name: 'management/', type: 'folder', desc: 'Custom commands', children: [
                    { name: 'commands/', type: 'folder', desc: '', children: [
                        { name: 'seed_data.py', type: 'py', desc: 'Database seeder â€” inserts synthetic data' },
                    ]}
                ]},
            ]},
            { name: 'doctors/', type: 'folder', desc: 'Doctor CRUD App', children: [
                { name: 'models.py', type: 'py', desc: 'Doctor model (7 fields + created_by FK)' },
                { name: 'serializers.py', type: 'py', desc: 'DoctorSerializer (ModelSerializer)' },
                { name: 'views.py', type: 'py', desc: 'DoctorListCreateView + DoctorDetailView' },
                { name: 'urls.py', type: 'py', desc: '"", "<int:pk>/"' },
                { name: 'admin.py', type: 'py', desc: 'Admin with specialization filter' },
            ]},
            { name: 'mappings/', type: 'folder', desc: 'Patient-Doctor Mapping App', children: [
                { name: 'models.py', type: 'py', desc: 'PatientDoctorMapping (unique_together)' },
                { name: 'serializers.py', type: 'py', desc: 'MappingSerializer + MappingDetailSerializer' },
                { name: 'views.py', type: 'py', desc: 'List, ByPatient, Delete views' },
                { name: 'urls.py', type: 'py', desc: '"", "<int:pk>/", "patient/<int:patient_id>/"' },
                { name: 'admin.py', type: 'py', desc: 'Admin with patient/doctor search' },
            ]},
            { name: 'frontend/', type: 'folder', desc: 'UI App â€” Templates + Static Files', children: [
                { name: 'views.py', type: 'py', desc: '7 view functions (render templates)' },
                { name: 'urls.py', type: 'py', desc: '7 URL patterns for pages' },
                { name: 'templates/frontend/', type: 'folder', desc: 'Django HTML Templates', children: [
                    { name: 'base.html', type: 'html', desc: 'Base layout for auth pages' },
                    { name: 'app_base.html', type: 'html', desc: 'Base layout with navbar for dashboard' },
                    { name: 'login.html', type: 'html', desc: 'Login form page' },
                    { name: 'register.html', type: 'html', desc: 'Registration form page' },
                    { name: 'dashboard.html', type: 'html', desc: 'Main dashboard with stats' },
                    { name: 'patients.html', type: 'html', desc: 'Patient CRUD with modal form' },
                    { name: 'doctors.html', type: 'html', desc: 'Doctor CRUD with modal form' },
                    { name: 'mappings.html', type: 'html', desc: 'Patient-doctor assignment page' },
                ]},
                { name: 'static/frontend/', type: 'folder', desc: 'CSS and JavaScript', children: [
                    { name: 'css/style.css', type: 'css', desc: '339 lines â€” full app styling' },
                    { name: 'js/app.js', type: 'js', desc: 'apiRequest(), token management, alerts' },
                ]},
            ]},
        ]}
    ];

    function renderTree(items, container) {
        items.forEach(item => {
            const div = document.createElement('div');
            const typeClass = item.type === 'folder' ? 'tree-folder' :
                              item.type === 'py' ? 'tree-file-py' :
                              item.type === 'html' ? 'tree-file-html' :
                              item.type === 'js' ? 'tree-file-js' :
                              item.type === 'css' ? 'tree-file-css' : 'tree-file';

            const row = document.createElement('div');
            row.className = 'tree-item';
            row.innerHTML = `<span class="${typeClass}">${item.type === 'folder' ? 'ğŸ“ ' : 'ğŸ“„ '}${item.name}</span>` +
                           (item.desc ? ` <span class="tree-desc">â€” ${item.desc}</span>` : '');

            div.appendChild(row);

            if (item.children) {
                const childContainer = document.createElement('div');
                childContainer.className = 'tree-children';
                renderTree(item.children, childContainer);
                div.appendChild(childContainer);

                row.addEventListener('click', (e) => {
                    e.stopPropagation();
                    childContainer.classList.toggle('open');
                    const icon = row.querySelector(`.${typeClass}`);
                    if (childContainer.classList.contains('open')) {
                        icon.textContent = 'ğŸ“‚ ' + item.name;
                    } else {
                        icon.textContent = 'ğŸ“ ' + item.name;
                    }
                });
            }

            container.appendChild(div);
        });
    }

    // Render tree on load
    const treeContainer = document.getElementById('project-tree');
    if (treeContainer) {
        renderTree(treeData, treeContainer);
        // Auto-expand root
        const firstChildren = treeContainer.querySelector('.tree-children');
        if (firstChildren) firstChildren.classList.add('open');
    }
</script>

</body>
</html>
